{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-3b2808742b8ee970ae415d1e2602c82a.js","src/js/config.js","src/js/helpers.js","src/js/models/previewModel.js","node_modules/@parcel/runtime-js/lib/bundle-url.js","node_modules/@parcel/runtime-js/lib/relative-path.js","node_modules/@parcel/runtime-js/lib/runtime-76485fb7a54079835b2fec60ca62e908.js","src/js/views/view.js","src/js/views/previewView.js","src/js/views/searchView.js","src/js/controllers/previewController.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./bundle-manifest').register(JSON.parse(\"{\\\"ZWsfK\\\":\\\"preview.HASH_REF_20d399794d35dd7156904112d78cebb8.js\\\",\\\"6MDiI\\\":\\\"cerrar.HASH_REF_deea2576e315258d49cfcc3ffcb2d3a4.svg\\\"}\"));","export const API_URL = \"https://pixabay.com/api/?key=17167571-d840cd320f8aaa6d4b36831e4\";\r\nexport const TIMEOUT_SEC = 10;\r\nexport const TOTAL_RESULTS = 20;","import { TIMEOUT_SEC } from './config.js';\r\nexport const timeout = function(s) {\r\n    return new Promise(function(_, reject) {\r\n        setTimeout(() => {\r\n            reject(new Error(`Request took too long! Timeout after ${s} second`));\r\n        }, s * 1000);\r\n    });\r\n};\r\n\r\nexport const getJSON = async function(url) {\r\n    try {\r\n        const res = await Promise.race([fetch(url), timeout(TIMEOUT_SEC)]);\r\n        const data = await res.json();\r\n        if(!res.ok) throw new Error(\"no results found! Please try again\");\r\n        return data;\r\n    } catch (error) { \r\n        throw error; \r\n    }\r\n};","import { API_URL } from \"../config.js\";\r\nimport { getJSON } from \"../helpers.js\";\r\n\r\nexport const state = {\r\n    data: {},\r\n    tags: [],\r\n    relations: []\r\n}\r\n\r\nexport const loadPreview = async function(id) {\r\n    try {\r\n        const data = await getJSON(`${API_URL}&id=${id}`);\r\n        state.data = data.hits[0];\r\n        state.tags =  state.data.tags.split(',');\r\n    } catch (error) { throw error; }  \r\n};\r\n\r\nexport const loadRelationsPreview = async function() {\r\n    try {\r\n         const query = state.tags.map(tag => tag).join('');\r\n         const relations = await getJSON(`${API_URL}&q=${query}&per_page=3`);\r\n         state.relations = relations;\r\n    } catch (error) { throw error; }\r\n}","\"use strict\";\n\n/* globals document:readonly */\nvar bundleURL = null;\n\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  let matches = ('' + url).match(/(https?|file|ftp):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","\"use strict\";\n\nvar resolve = require('./bundle-manifest').resolve;\n\nmodule.exports = function (fromId, toId) {\n  return relative(dirname(resolve(fromId)), resolve(toId));\n};\n\nfunction dirname(_filePath) {\n  if (_filePath === '') {\n    return '.';\n  }\n\n  var filePath = _filePath[_filePath.length - 1] === '/' ? _filePath.slice(0, _filePath.length - 1) : _filePath;\n  var slashIndex = filePath.lastIndexOf('/');\n  return slashIndex === -1 ? '.' : filePath.slice(0, slashIndex);\n}\n\nfunction relative(from, to) {\n  if (from === to) {\n    return '';\n  }\n\n  var fromParts = from.split('/');\n\n  if (fromParts[0] === '.') {\n    fromParts.shift();\n  }\n\n  var toParts = to.split('/');\n\n  if (toParts[0] === '.') {\n    toParts.shift();\n  } // Find where path segments diverge.\n\n\n  var i;\n  var divergeIndex;\n\n  for (i = 0; (i < toParts.length || i < fromParts.length) && divergeIndex == null; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      divergeIndex = i;\n    }\n  } // If there are segments from \"from\" beyond the point of divergence,\n  // return back up the path to that point using \"..\".\n\n\n  var parts = [];\n\n  for (i = 0; i < fromParts.length - divergeIndex; i++) {\n    parts.push('..');\n  } // If there are segments from \"to\" beyond the point of divergence,\n  // continue using the remaining segments.\n\n\n  if (toParts.length > divergeIndex) {\n    parts.push.apply(parts, toParts.slice(divergeIndex));\n  }\n\n  return parts.join('/');\n}\n\nmodule.exports._dirname = dirname;\nmodule.exports._relative = relative;","module.exports = require('./bundle-url').getBundleURL() + require('./relative-path')(\"ZWsfK\", \"6MDiI\")","import cerrar from 'url:../../images/cerrar.svg';\r\nclass View {\r\n    _component = document.querySelector('.component');\r\n    message = \"It seems that an error has occurred! Please please try again\";\r\n    _data;\r\n\r\n    render(data){\r\n      if(!data || Array.isArray(data) && data.length === 0 ) return this.renderError();\r\n        this._data = data;\r\n        const markup = this._generateMarkup();\r\n        this._clear();\r\n        this._parentElement.insertAdjacentHTML('afterbegin', markup);\r\n    }\r\n\r\n    _clear(){ \r\n      this._parentElement.innerHTML = \"\"; \r\n      this._component.innerHTML = \"\";\r\n    }\r\n\r\n    renderSpinner(){\r\n        const markup = `\r\n        <div class=\"lds-ring\"><div></div><div></div><div></div><div>\r\n        `;\r\n        this._clear();\r\n        this._component.insertAdjacentHTML('afterbegin', markup);\r\n    };\r\n\r\n    renderError(message = this.message){\r\n       const markup = `\r\n        <div class=\"error\">\r\n          <div>\r\n            <img src=\"${cerrar}\" alt=\"error\" />\r\n          </div>\r\n          <h1>${message}</h1>\r\n        </div>\r\n       `;\r\n       this._clear();\r\n       this._component.insertAdjacentHTML('afterbegin', markup);\r\n    }\r\n\r\n};\r\n\r\nexport default View;","import view from \"./view.js\";\r\n\r\nclass PreviewView extends view {\r\n\r\n    _parentElement = document.querySelector('.preview');\r\n\r\n    _generateMarkup(){\r\n        const { data, relations : { hits } } = this._data;\r\n       return `\r\n        <div class=\"preview__image\" >\r\n            <h1>${data.tags}</h1>\r\n            <img src=\"${data.largeImageURL}\", alt=\"${data.tags}\" />\r\n        </div>\r\n        <div class=\"preview__content\">\r\n            <div class=\"preview__user\">\r\n                <img src=\"${data.userImageURL}\", alt=\"${data.user}\" />\r\n                <a \r\n                    href=\"https://pixabay.com/users/${data.user}-${data.user_id}\"\r\n                    target=\"_blank\"    \r\n                >\r\n                    ${data.user}\r\n                </a>\r\n            </div>\r\n            <div class=\"preview__download\">\r\n                <p>Free for commercial use, No attribution required</p>\r\n                <a href=\"${data.pageURL}\" target=\"_blank\" >Free Download</a>\r\n            </div>\r\n            <div class=\"preview__related--box\">\r\n                <h1> Related Images </h1>\r\n                ${hits.map(this._generateRelationsMarkup).join('')}\r\n            </div>\r\n        </div>\r\n       `;\r\n    }\r\n\r\n    _generateRelationsMarkup(image){\r\n        return `\r\n            <div class=\"relate--image\">\r\n                <a href=\"/preview.html/?id=${image.id} \">\r\n                    <img src=\"${image.webformatURL}\" />\r\n                </a>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    addHandleLoadPreview(handle){\r\n        window.addEventListener('load', handle);\r\n    }\r\n}\r\n\r\nexport default new PreviewView();","import view from \"./view.js\";\r\n\r\nclass SearchView extends view {\r\n    _parentElement = document.querySelector('.search');\r\n    message = \"No results found, please try another name\";\r\n\r\n    getQuery(){\r\n        const query = this._parentElement.querySelector('.search__input').value;\r\n        this._clearInputValue();\r\n        return query;\r\n    }\r\n\r\n    _clearInputValue(){ this._parentElement.querySelector('.search__input').value = \"\"; }\r\n\r\n    addHandleSearchClick(handle){\r\n        this._parentElement.addEventListener('submit', function(e) {\r\n            e.preventDefault();\r\n            handle();\r\n        })\r\n    }\r\n\r\n}\r\n\r\nexport default new SearchView();","import * as model from '../models/previewModel.js';\r\nimport previewView from '../views/previewView.js';\r\nimport searchView from '../views/searchView.js';\r\n\r\n\r\nconst controllerLoadPreview = async function() {  \r\n    try {\r\n        // loading...\r\n        previewView.renderSpinner();\r\n        // get id preview\r\n        const id = new URLSearchParams(location.search).get(\"id\");\r\n        if(!id) throw new Error(\"No results found :(\");\r\n        // get preview\r\n        await model.loadPreview(id);\r\n        // get relations image\r\n        await model.loadRelationsPreview();\r\n        // render preview\r\n        previewView.render(model.state);\r\n    } catch (error) { previewView.renderError(error.message);}\r\n};\r\n\r\nconst controllerSearch = function() {\r\n    const query = searchView.getQuery();\r\n    if(!query) return ;\r\n    window.location.replace(`/home.html/?search=${query}`);\r\n};\r\n\r\nconst init = function() {\r\n    searchView.addHandleSearchClick(controllerSearch);\r\n    previewView.addHandleLoadPreview(controllerLoadPreview);\r\n};\r\n\r\ninit();"],"names":["$7d806a7a603c235ec027b73d847f4d95$var$mapping","$7d806a7a603c235ec027b73d847f4d95$export$357eb1b4f03c1402","pairs","keys","Object","i","length","$7d806a7a603c235ec027b73d847f4d95$export$40339995e8a21591","id","resolved","Error","parcelRequire","register","JSON","parse","$cf3d800fb17fd2d1b0082d5ade4c0602$export$121552fae10d4c49","$37f17f2cfa7c1f359151dec56797b63a$export$578f55a5d60842ba","async","url","res","Promise","race","fetch","s","_","reject","setTimeout","data","json","ok","error","$e8dbd261964d8b5b7dbccc0d9b6d17dc$export$c837a8b98c265ae3","tags","relations","$634f916bc30b7d6650877f3f4b6a8b3a$var$bundleURL","$634f916bc30b7d6650877f3f4b6a8b3a$var$getBaseURL","replace","$634f916bc30b7d6650877f3f4b6a8b3a$export$da289beea9c5b10d","err","matches","stack","match","$634f916bc30b7d6650877f3f4b6a8b3a$var$getBundleURL","resolve","$824bc590bf0a3702ac7bd27152cb0639$var$dirname","_filePath","filePath","slice","slashIndex","lastIndexOf","$824bc590bf0a3702ac7bd27152cb0639$var$relative","from","to","fromParts","split","shift","divergeIndex","toParts","parts","push","apply","join","module","exports","fromId","toId","$824bc590bf0a3702ac7bd27152cb0639$require$resolve","_dirname","_relative","$2092bc8065a55b129d8176ebb4e67f18$exports","getBundleURL","$90a9ec88b0022664e8fac599ef413374$export$9099ad97b570f7c","[object Object]","document","querySelector","Array","isArray","this","renderError","_data","markup","_generateMarkup","_clear","_parentElement","insertAdjacentHTML","innerHTML","_component","message","$parcel$interopDefault","$73b9aef2cd69488b907f83bb5fda863f$export$9099ad97b570f7c","hits","largeImageURL","userImageURL","user","user_id","pageURL","map","_generateRelationsMarkup","image","webformatURL","handle","window","addEventListener","$df7046c04f597bc3ca70999db58035f3$export$9099ad97b570f7c","query","value","_clearInputValue","e","preventDefault","$d2719bf740af5793a17dec81027d0054$var$controllerLoadPreview","renderSpinner","URLSearchParams","location","search","get","$e8dbd261964d8b5b7dbccc0d9b6d17dc$export$52623129eb565a21","tag","$e8dbd261964d8b5b7dbccc0d9b6d17dc$export$45da25cad8e47515","render","$d2719bf740af5793a17dec81027d0054$var$controllerSearch","getQuery","addHandleSearchClick","addHandleLoadPreview"],"version":3,"file":"preview.HASH_REF_20d399794d35dd7156904112d78cebb8.js.map"}